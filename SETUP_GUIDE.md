# セットアップガイド

## 1. Chrome拡張機能の読み込み

### ステップ1: 拡張機能ページを開く

Chromeのアドレスバーに以下を入力：
```
chrome://extensions/
```

または、Chromeメニュー（︙）→「拡張機能」→「拡張機能を管理」

### ステップ2: デベロッパーモードを有効化

右上の「**デベロッパーモード**」トグルをオンにします。

### ステップ3: 拡張機能を読み込む

1. 「**パッケージ化されていない拡張機能を読み込む**」をクリック
2. `google-calendar-ai-assistant` フォルダを選択
3. 「フォルダを選択」をクリック

### ステップ4: 拡張機能IDをコピー

読み込まれた拡張機能の下に表示される「ID: xxxxx...」をコピーしておきます。
（後でGoogle Cloud Consoleで使用します）

---

## 2. OpenAI APIキーの取得

### ステップ1: OpenAIにサインアップ/ログイン

https://platform.openai.com/ にアクセス

### ステップ2: APIキーを作成

1. 右上のアカウントメニューから「API keys」を選択
2. 「Create new secret key」をクリック
3. 名前を入力（例: Calendar Assistant）
4. APIキーをコピーして安全な場所に保存

**注意**: APIキーは一度しか表示されません！

---

## 3. Google Cloud Consoleの設定

### ステップ1: プロジェクトの作成

1. https://console.cloud.google.com/ にアクセス
2. 上部の「プロジェクトを選択」→「新しいプロジェクト」
3. プロジェクト名を入力（例: calendar-ai-assistant）
4. 「作成」をクリック
5. 作成したプロジェクトを選択

### ステップ2: Google Calendar APIを有効化

1. 左メニューから「APIとサービス」→「ライブラリ」
2. 検索ボックスに「Google Calendar API」と入力
3. 「Google Calendar API」をクリック
4. 「有効にする」をクリック

### ステップ3: OAuth同意画面を設定

1. 左メニューから「APIとサービス」→「OAuth同意画面」
2. User Type: **外部**を選択 → 「作成」
3. アプリ情報を入力：
   - **アプリ名**: Google Calendar AI Assistant
   - **ユーザーサポートメール**: 自分のメールアドレス
   - **デベロッパーの連絡先情報**: 自分のメールアドレス
4. 「保存して次へ」をクリック
5. スコープ画面: 何も追加せず「保存して次へ」
6. **テストユーザー**画面:
   - 「ADD USERS」をクリック
   - **自分のGmailアドレスを追加**（重要！）
   - 「保存して次へ」
7. 「ダッシュボードに戻る」をクリック

### ステップ4: OAuth認証情報を作成

1. 左メニューから「APIとサービス」→「認証情報」
2. 上部の「+認証情報を作成」→「OAuth クライアント ID」
3. アプリケーションの種類: **ウェブ アプリケーション**
4. 名前: Calendar AI Assistant
5. **承認済みのリダイレクトURI**:
   - 「URIを追加」をクリック
   - 以下を入力（拡張機能IDを自分のものに置き換え）:
     ```
     https://[あなたの拡張機能ID].chromiumapp.org/
     ```
     例: `https://abcdefghijklmnop.chromiumapp.org/`
6. 「作成」をクリック
7. **クライアントID**と**クライアントシークレット**が表示されます
8. 両方をコピーして保存

**拡張機能IDの確認方法**:
- Chrome拡張機能ページ（chrome://extensions/）で確認
- または、拡張機能の設定画面で「セットアップ手順を表示」をクリック

---

## 4. 拡張機能の設定

### ステップ1: 設定画面を開く

1. Chromeツールバーの「Google Calendar AI Assistant」アイコンをクリック
2. サイドパネルが開いたら、右上の「⚙️」（設定）アイコンをクリック

### ステップ2: OpenAI API設定

1. **APIキー**: 先ほどコピーしたOpenAI APIキーを貼り付け
2. **モデル**: GPT-4 Turbo（推奨）を選択

### ステップ3: Google Calendar API設定

1. **Google Client ID**: Google Cloud ConsoleでコピーしたクライアントIDを貼り付け
2. **Google Client Secret**: クライアントシークレットを貼り付け

### ステップ4: 保存と認証

1. 「**保存**」ボタンをクリック
2. 「**Googleアカウントで認証**」ボタンをクリック
3. Googleのログイン画面が表示されます
4. アカウントを選択
5. 「このアプリは確認されていません」と表示された場合:
   - 「詳細」をクリック
   - 「[アプリ名]に移動」をクリック
6. カレンダーへのアクセスを許可
7. 認証成功！

### ステップ5: 動作確認

1. サイドパネルに戻る
2. ステータスが「準備完了」になっていることを確認
3. テストメッセージを送信:
   ```
   明日の予定を教えて
   ```

---

## トラブルシューティング

### 「リダイレクトURIが一致しません」エラー

**原因**: Google Cloud ConsoleのリダイレクトURIが間違っている

**解決方法**:
1. Chrome拡張機能ページで拡張機能IDを再確認
2. Google Cloud Console → 認証情報 → 作成したOAuth 2.0クライアントIDを編集
3. リダイレクトURIを修正:
   ```
   https://[正しい拡張機能ID].chromiumapp.org/
   ```
4. 保存

### 「このアプリは確認されていません」が消えない

**原因**: テストユーザーに自分のメールアドレスが追加されていない

**解決方法**:
1. Google Cloud Console → OAuth同意画面
2. 「テストユーザー」セクションで自分のメールアドレスを追加
3. 保存後、再度認証を試す

### 「認証が必要です」と表示される

**解決方法**:
1. 設定画面でClient IDとSecretが正しく入力されているか確認
2. 保存ボタンをクリック
3. 再度「Googleアカウントで認証」をクリック

### APIキーエラー

**OpenAI APIキーエラー**:
- APIキーが`sk-`で始まっているか確認
- OpenAIアカウントに支払い方法が登録されているか確認
- APIキーが有効か確認（削除されていないか）

---

## 完了！

設定が完了したら、以下のように使えます：

```
ユーザー: 2月3日の会議、翌日に移動させといて
AI: 2月3日の「部門会議」を2月4日に移動しますね...
```

問題が解決しない場合は、以下を確認：
- Chrome拡張機能がエラーなく読み込まれているか
- すべての設定が保存されているか
- インターネット接続が安定しているか
